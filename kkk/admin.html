<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - IdeaHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
        }

        .navbar {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .navbar h1 {
            font-size: 1.5em;
        }

        .navbar button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .navbar button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #ddd;
        }

        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #764ba2;
            border-bottom-color: #764ba2;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #764ba2;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #999;
            font-size: 0.95em;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .chart-title {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
        }

        .chart-bar {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .chart-label {
            min-width: 150px;
            font-weight: 600;
            color: #333;
        }

        .chart-bar-fill {
            flex: 1;
            height: 25px;
            background: linear-gradient(90deg, #764ba2 0%, #667eea 100%);
            margin: 0 15px;
            border-radius: 5px;
            position: relative;
        }

        .chart-value {
            min-width: 50px;
            text-align: right;
            font-weight: 600;
            color: #667eea;
        }

        .table-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f9f9f9;
            border-bottom: 2px solid #eee;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #333;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #555;
        }

        tr:hover {
            background: #fafafa;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            background: #667eea;
            color: white;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .badge-success {
            background: #51cf66;
        }

        .badge-warning {
            background: #ffd93d;
            color: #333;
        }

        .badge-danger {
            background: #ff6b6b;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #764ba2;
            color: white;
        }

        .btn-primary:hover {
            background: #63398a;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.85em;
        }

        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            max-width: 400px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: #999;
        }

        .modal-header {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
        }

        .insight-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .insight-title {
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .insight-value {
            font-size: 1.3em;
            margin-top: 10px;
        }

        .collaboration-list {
            list-style: none;
        }

        .collab-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .collab-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .collab-requester {
            font-weight: 700;
            color: #333;
        }

        .collab-reason {
            color: #666;
            line-height: 1.5;
            margin: 10px 0;
        }

        .collab-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .collab-actions button {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
        }

        .btn-approve {
            background: #51cf66;
            color: white;
        }

        .btn-reject {
            background: #ff6b6b;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <h1>üë®‚Äçüíº Admin Dashboard - IdeaHub</h1>
        <button onclick="logout()">‚Üê Back to Role Select</button>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">üìä Overview</button>
            <button class="tab-btn" onclick="switchTab('ideas')">üí° All Ideas</button>
            <button class="tab-btn" onclick="switchTab('collaborations')">ü§ù Collaborations</button>
            <button class="tab-btn" onclick="switchTab('insights')">üéØ Insights</button>
            <button class="tab-btn" onclick="switchTab('export')">üì• Export Data</button>
        </div>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalIdeasCount">0</div>
                    <div class="stat-label">Total Ideas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalStudentsCount">0</div>
                    <div class="stat-label">Active Students</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalUpvotesCount">0</div>
                    <div class="stat-label">Total Upvotes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="collabRequestsCount">0</div>
                    <div class="stat-label">Collab Requests</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgUpvotesCount">0</div>
                    <div class="stat-label">Avg Upvotes/Idea</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalPointsCount">0</div>
                    <div class="stat-label">Total Points Awarded</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title">üìà Ideas by Category</div>
                    <div id="categoryChart"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">üå≥ Ideas by Branch</div>
                    <div id="branchChart"></div>
                </div>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Idea Title</th>
                            <th>Author</th>
                            <th>College ID</th>
                            <th>Category</th>
                            <th>Upvotes</th>
                            <th>Comments</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody id="recentIdeasTable">
                        <tr>
                            <td colspan="7" style="text-align: center; color: #999;">No ideas yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Ideas Tab -->
        <div id="ideas" class="tab-content">
            <div class="search-box">
                <input type="text" id="searchIdeas" placeholder="Search ideas by title or author..." onkeyup="filterIdeas()">
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Author</th>
                            <th>Branch</th>
                            <th>Category</th>
                            <th>Upvotes</th>
                            <th>Collab Needed</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ideasTable">
                        <tr>
                            <td colspan="7" style="text-align: center; color: #999;">No ideas yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Collaborations Tab -->
        <div id="collaborations" class="tab-content">
            <div id="collaborationsList" class="collaboration-list">
                <div class="empty-state">
                    <p>No collaboration requests yet</p>
                </div>
            </div>
        </div>

        <!-- Insights Tab -->
        <div id="insights" class="tab-content">
            <div class="insight-card">
                <div class="insight-title">üéØ Key Insights</div>
                <div id="insightsContainer">
                    <p style="margin-top: 10px;">No data available yet</p>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-title">üë• Top Authors</div>
                    <div id="topAuthorsChart"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-title">üèÜ Trending Ideas</div>
                    <div id="trendingIdeasChart"></div>
                </div>
            </div>
        </div>

        <!-- Export Tab -->
        <div id="export" class="tab-content">
            <div style="background: white; padding: 30px; border-radius: 10px;">
                <h2 style="margin-bottom: 20px;">üì• Export Data</h2>
                <p style="color: #666; margin-bottom: 20px;">Export all student ideas with their details to Excel format.</p>
                <button class="btn btn-primary" onclick="exportToExcel()" style="padding: 12px 30px; font-size: 1em;">
                    üìä Download as Excel
                </button>
                <div id="exportStatus" style="margin-top: 20px; color: #666;"></div>
            </div>
        </div>
    </div>

    <!-- Modal for Idea Details -->
    <div id="ideaModal" class="modal">
        <button class="modal-close" onclick="closeModal('ideaModal')">‚úï</button>
        <div class="modal-content">
            <div class="modal-header" id="modalTitle">Idea Details</div>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>

    <script>
        // Data
        let ideas = JSON.parse(localStorage.getItem('ideas')) || [];
        let collaborations = JSON.parse(localStorage.getItem('collaborations')) || [];

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            refreshAdminDashboard();
            loadIdeasTable();
            loadCollaborations();
            loadInsights();
        });

        function refreshAdminDashboard() {
            // Count stats
            const totalIdeas = ideas.length;
            const uniqueStudents = new Set(ideas.map(i => i.author)).size;
            const totalUpvotes = ideas.reduce((sum, i) => sum + i.upvotes, 0);
            const collabRequests = collaborations.filter(c => c.status === 'pending').length;
            const avgUpvotes = totalIdeas > 0 ? Math.round(totalUpvotes / totalIdeas * 10) / 10 : 0;
            const totalPoints = ideas.reduce((sum, i) => sum + (i.points || 10), 0);

            document.getElementById('totalIdeasCount').textContent = totalIdeas;
            document.getElementById('totalStudentsCount').textContent = uniqueStudents;
            document.getElementById('totalUpvotesCount').textContent = totalUpvotes;
            document.getElementById('collabRequestsCount').textContent = collabRequests;
            document.getElementById('avgUpvotesCount').textContent = avgUpvotes;
            document.getElementById('totalPointsCount').textContent = totalPoints;

            // Category chart
            const categoryData = {};
            ideas.forEach(idea => {
                categoryData[idea.category] = (categoryData[idea.category] || 0) + 1;
            });

            const categoryChart = document.getElementById('categoryChart');
            categoryChart.innerHTML = Object.entries(categoryData)
                .sort((a, b) => b[1] - a[1])
                .map(([cat, count]) => `
                    <div class="chart-bar">
                        <div class="chart-label">${cat}</div>
                        <div class="chart-bar-fill" style="width: ${(count / totalIdeas * 100)}%"></div>
                        <div class="chart-value">${count}</div>
                    </div>
                `).join('');

            // Branch chart
            const branchData = {};
            ideas.forEach(idea => {
                branchData[idea.branch || 'Unknown'] = (branchData[idea.branch || 'Unknown'] || 0) + 1;
            });

            const branchChart = document.getElementById('branchChart');
            branchChart.innerHTML = Object.entries(branchData)
                .sort((a, b) => b[1] - a[1])
                .map(([branch, count]) => `
                    <div class="chart-bar">
                        <div class="chart-label">${branch}</div>
                        <div class="chart-bar-fill" style="width: ${(count / totalIdeas * 100)}%"></div>
                        <div class="chart-value">${count}</div>
                    </div>
                `).join('');

            // Recent ideas table
            const recentIdeas = ideas.slice(-5).reverse();
            const tableBody = document.getElementById('recentIdeasTable');
            if (recentIdeas.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">No ideas yet</td></tr>';
            } else {
                tableBody.innerHTML = recentIdeas.map(idea => `
                    <tr>
                        <td><strong>${idea.title}</strong></td>
                        <td>${idea.author}</td>
                        <td>${idea.collegeId}</td>
                        <td><span class="badge">${idea.category}</span></td>
                        <td><strong>${idea.upvotes}</strong></td>
                        <td>${idea.comments.length}</td>
                        <td>${idea.createdAt}</td>
                    </tr>
                `).join('');
            }
        }

        function loadIdeasTable() {
            const tableBody = document.getElementById('ideasTable');
            if (ideas.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">No ideas yet</td></tr>';
                return;
            }

            tableBody.innerHTML = ideas.map(idea => `
                <tr>
                    <td><strong>${idea.title}</strong></td>
                    <td>${idea.author}</td>
                    <td>${idea.branch}</td>
                    <td><span class="badge">${idea.category}</span></td>
                    <td><strong>${idea.upvotes}</strong></td>
                    <td>${idea.needCollab ? '<span class="badge badge-success">Yes</span>' : 'No'}</td>
                    <td><button class="btn btn-primary btn-small" onclick="viewIdeaDetails(${idea.id})">View</button></td>
                </tr>
            `).join('');
        }

        function filterIdeas() {
            const searchTerm = document.getElementById('searchIdeas').value.toLowerCase();
            const tableBody = document.getElementById('ideasTable');

            const filtered = ideas.filter(idea =>
                idea.title.toLowerCase().includes(searchTerm) ||
                idea.author.toLowerCase().includes(searchTerm)
            );

            if (filtered.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #999;">No results found</td></tr>';
                return;
            }

            tableBody.innerHTML = filtered.map(idea => `
                <tr>
                    <td><strong>${idea.title}</strong></td>
                    <td>${idea.author}</td>
                    <td>${idea.branch}</td>
                    <td><span class="badge">${idea.category}</span></td>
                    <td><strong>${idea.upvotes}</strong></td>
                    <td>${idea.needCollab ? '<span class="badge badge-success">Yes</span>' : 'No'}</td>
                    <td><button class="btn btn-primary btn-small" onclick="viewIdeaDetails(${idea.id})">View</button></td>
                </tr>
            `).join('');
        }

        function viewIdeaDetails(ideaId) {
            const idea = ideas.find(i => i.id === ideaId);
            if (!idea) return;

            document.getElementById('modalTitle').textContent = idea.title;
            document.getElementById('modalBody').innerHTML = `
                <div style="margin-bottom: 20px;">
                    <p><strong>Author:</strong> ${idea.author}</p>
                    <p><strong>College ID:</strong> ${idea.collegeId}</p>
                    <p><strong>Section:</strong> ${idea.section}</p>
                    <p><strong>Branch:</strong> ${idea.branch}</p>
                    <p><strong>Category:</strong> <span class="badge">${idea.category}</span></p>
                    <p><strong>Created:</strong> ${idea.createdAt}</p>
                    <p><strong>Looking for Collaboration:</strong> ${idea.needCollab ? 'Yes' : 'No'}</p>
                </div>
                <div style="background: #f9f9f9; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                    <strong>Description:</strong>
                    <p style="margin-top: 10px; line-height: 1.6;">${idea.desc}</p>
                </div>
                <div>
                    <strong>Stats:</strong>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px;">
                        <div style="background: #f9f9f9; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: 700; color: #667eea;">${idea.upvotes}</div>
                            <div style="font-size: 0.9em; color: #999;">Upvotes</div>
                        </div>
                        <div style="background: #f9f9f9; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: 700; color: #667eea;">${idea.comments.length}</div>
                            <div style="font-size: 0.9em; color: #999;">Comments</div>
                        </div>
                        <div style="background: #f9f9f9; padding: 10px; border-radius: 5px; text-align: center;">
                            <div style="font-size: 1.5em; font-weight: 700; color: #667eea;">${idea.points || 10}</div>
                            <div style="font-size: 0.9em; color: #999;">Points</div>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('ideaModal').classList.add('active');
        }

        function loadCollaborations() {
            const list = document.getElementById('collaborationsList');
            
            if (collaborations.length === 0) {
                list.innerHTML = '<div class="empty-state"><p>No collaboration requests yet</p></div>';
                return;
            }

            list.innerHTML = collaborations.map(collab => {
                const idea = ideas.find(i => i.id === collab.ideaId);
                return `
                    <div class="collab-item">
                        <div class="collab-header">
                            <span class="collab-requester">${collab.requesterName}</span>
                            <span class="badge ${collab.status === 'pending' ? '' : collab.status === 'approved' ? 'badge-success' : 'badge-danger'}">
                                ${collab.status.toUpperCase()}
                            </span>
                        </div>
                        <div style="color: #999; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Project:</strong> ${idea ? idea.title : 'Deleted'}
                        </div>
                        <div style="color: #999; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>College ID:</strong> ${collab.requesterCollegeId}
                        </div>
                        <div class="collab-reason">
                            <strong>Reason:</strong> ${collab.reason}
                        </div>
                        <div style="color: #999; font-size: 0.85em;">
                            Requested: ${collab.createdAt}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadInsights() {
            const insights = document.getElementById('insightsContainer');
            
            if (ideas.length === 0) {
                insights.innerHTML = '<p>No data available yet</p>';
                return;
            }

            const totalIdeas = ideas.length;
            const avgUpvotes = Math.round(ideas.reduce((sum, i) => sum + i.upvotes, 0) / totalIdeas * 10) / 10;
            const trendingIdeas = ideas.filter(i => i.upvotes >= avgUpvotes).length;
            const collabNeeded = ideas.filter(i => i.needCollab).length;

            insights.innerHTML = `
                <p style="margin-top: 10px;">
                    üìä Total <strong>${totalIdeas}</strong> ideas have been posted with an average of <strong>${avgUpvotes}</strong> upvotes per idea.
                </p>
                <p style="margin-top: 10px;">
                    üî• <strong>${trendingIdeas}</strong> ideas are trending (above average upvotes).
                </p>
                <p style="margin-top: 10px;">
                    ü§ù <strong>${collabNeeded}</strong> ideas are looking for collaborators.
                </p>
                <p style="margin-top: 10px;">
                    üë• <strong>${new Set(ideas.map(i => i.author)).size}</strong> unique students have contributed.
                </p>
                <p style="margin-top: 10px;">
                    üí¨ Total <strong>${ideas.reduce((sum, i) => sum + i.comments.length, 0)}</strong> comments across all ideas.
                </p>
            `;

            // Top authors
            const authorStats = {};
            ideas.forEach(idea => {
                authorStats[idea.author] = (authorStats[idea.author] || 0) + 1;
            });

            const topAuthors = Object.entries(authorStats)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            const topAuthorsChart = document.getElementById('topAuthorsChart');
            topAuthorsChart.innerHTML = topAuthors.map(([author, count]) => `
                <div class="chart-bar">
                    <div class="chart-label">${author}</div>
                    <div class="chart-bar-fill" style="width: ${(count / Math.max(...topAuthors.map(a => a[1])) * 100)}%"></div>
                    <div class="chart-value">${count}</div>
                </div>
            `).join('');

            // Trending ideas
            const trendingTop = ideas
                .sort((a, b) => b.upvotes - a.upvotes)
                .slice(0, 5);

            const trendingChart = document.getElementById('trendingIdeasChart');
            const maxUpvotes = Math.max(...ideas.map(i => i.upvotes), 1);
            trendingChart.innerHTML = trendingTop.map(idea => `
                <div class="chart-bar">
                    <div class="chart-label" style="max-width: 150px; overflow: hidden; text-overflow: ellipsis;">${idea.title}</div>
                    <div class="chart-bar-fill" style="width: ${(idea.upvotes / maxUpvotes * 100)}%"></div>
                    <div class="chart-value">${idea.upvotes}</div>
                </div>
            `).join('');
        }

        function exportToExcel() {
            if (ideas.length === 0) {
                alert('No ideas to export');
                return;
            }

            const data = ideas.map(idea => ({
                'Idea Title': idea.title,
                'Description': idea.desc,
                'Author Name': idea.author,
                'College ID': idea.collegeId,
                'Section': idea.section,
                'Branch': idea.branch,
                'Category': idea.category,
                'Upvotes': idea.upvotes,
                'Comments': idea.comments.length,
                'Collaboration Needed': idea.needCollab ? 'Yes' : 'No',
                'Created Date': idea.createdAt
            }));

            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Ideas');

            // Set column widths
            worksheet['!cols'] = [
                { wch: 25 },
                { wch: 40 },
                { wch: 15 },
                { wch: 12 },
                { wch: 10 },
                { wch: 12 },
                { wch: 12 },
                { wch: 10 },
                { wch: 10 },
                { wch: 18 },
                { wch: 15 }
            ];

            XLSX.writeFile(workbook, 'IdeaHub_Ideas_' + new Date().toISOString().split('T')[0] + '.xlsx');

            document.getElementById('exportStatus').textContent = '‚úÖ Excel file exported successfully!';
            setTimeout(() => {
                document.getElementById('exportStatus').textContent = '';
            }, 3000);
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'overview') {
                refreshAdminDashboard();
            } else if (tabName === 'ideas') {
                loadIdeasTable();
            } else if (tabName === 'collaborations') {
                loadCollaborations();
            } else if (tabName === 'insights') {
                loadInsights();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function logout() {
            sessionStorage.removeItem('userRole');
            window.location.href = 'index.html';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('ideaModal');
            if (event.target === modal) {
                modal.classList.remove('active');
            }
        }
    </script>
</body>
</html>
